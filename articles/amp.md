# AMP

Для высокой скорости загрузки сайтов мы применяем основные рекомендации Google, таким образом сайты находятся в зеленой зоне PageSpeed и на всех устройствах загружаются максимально быстро. 
Но для медленных соединений этого может быть недостаточно + быстрый сайт не всегда в топе поисковой выдачи. Поэтому 
на разрабатываемых сайтах мы используем технологию AMP.

Accelerated Mobile Pages (AMP) — технология ускоренных мобильных страниц, позволяет при низкой скорости сети выполнить оперативную загрузку веб-страниц.

Основные преимущества AMP страниц:
- АМР-страница загружается за 0.7 секунды, как утверждают специалисты Google;
- AMP-страница показывается в карусели фото/записей в поисковой выдаче;
- В поисковой выдаче AMP страница помечена значком молнии, привлекая внимание + такие страницы в мобильной выдаче ранжируются выше;
- В поисковой выдаче AMP страница находится в кэше поисковика, т.е её содержимое отдаётся мгновенно без обращения на сервер сайта.

Отличия AMP страниц от обычных:
- Отсутствие кастомных скриптов;
- Отсутствие обычных ```<img>``` тегов в документе;
- В коде страницы не должно быть inline-стилей;
- Структурированная схема данных (она у нас и так есть);
- Ссылки canonical и обратная к ней;
- CSS не более 50 кб (для больших сайтов очень непросто).

### От адаптивного сайта к AMP
Так как мы разрабатываем сайты на CMS Битрикс, то для перевода обычного сайта на AMP, было сделано:
- Был скопирован шаблон сайта;
- На событие ```OnEndBufferContent``` AMP шаблона было повешено удаления битриксовых скриптов, т.к они запрещены в AMP. Страницы уже не будут композитными :(;
- Добавлены основные элементы AMP страниц: html amp, application/ld+json, canonical и др.;
- В 5 раз был уменьшен CSS файл для соответсвия требованиям: использованы более короткие имена классов, модификаторов, удалены стили не AMP страниц, уменьшено число шагов адативности у некоторых блоков
- Т.к в AMP нелья использовать inline стили, а сам файл стилей должен находиться в header, все ссылки изображений выводимые компонентами пришлось прокидывать в header с помощью отложенных функций ```ShowViewContent```, ```SetViewTarget```-```EndViewTarget```;
- На замену слайдерам, меню, картам, выпадающим спискам были найдены соответствующие AMP компоненты.

В результате был разработан AMP шаблон битриксового сайта с централизованым администрированием.

```
Минимальное время загрузки главной страницы обычного сайта (оптимизация PageSpeed 90/100) 2.3s, а AMP 0,86s
```

